language: python
sudo: false
cache: pip
services:
  - docker
senv:
  global:
    - LD_PRELOAD=/lib/x86_64-linux-gnu/libSegFault.so
    - SEGFAULT_SIGNALS=all
matrix:
  include:
    - python: '3.8'
      env:
        - TOXENV=check
        - SCRIPT=tox
    - python: '3.8'
      env:
        - TOXENV=docs
        - SCRIPT=tox
    - python: '3.6'
      env:
        - TOXENV=3.6-nocov
        - SCRIPT=tox
    - python: '3.7'
      env:
        - TOXENV=3.7-cover,report,coveralls,codecov
        - SCRIPT=tox
    - python: '3.7'
      env:
        - TOXENV=3.7-nocov
        - SCRIPT=tox
    - python: '3.8'
      env:
        - TOXENV=3.8-nocov
        - SCRIPT=tox
    - python: '3.8'
      env:
        - SCRIPT=docker
before_install:
  - python --version
  - uname -a
  - lsb_release -a
install:
  - pip install tox twine
  - virtualenv --version
  - easy_install --version
  - pip --version
  - tox --version
script:
  - |
    case $SCRIPT in
      tox)
        tox -v
        ;;

      docker)
        docker build . -f docker/Dockerfile.test -t zsl-test
        docker run --rm zsl-test --version
        ;;
    esac
after_failure:
  - more .tox/log/* | cat
  - more .tox/*/log/* | cat
notifications:
  email:
    on_success: never
    on_failure: always
deploy:
  provider: pypi
  user: atteq
  edge: true
  password: "Y3dcTUFz8uNJT4K6J3lluiPCbasg3pG5C5huaF+ffA0OMgcLvLggYBfbO6YaV1d1BuC9BgFqIp0OM5JEmGv3SYNUn0PAfGaGu+jyo6XqZJeDMJ2WrI5OP9eZrWPm6CPtvtR9y1EMFyBKyeBWPJvP+0s9awi+1BhKHJrpq8dta2bU4TSaepdMAuk/B1Gs0l14NpXxMxIUdd72NddFtzYG5OnRvEcn+GiT72fPpL72RiHXA4pWeVE2SAKvFYeWEWOVmeh3MgPkaL/HfcwOM8qer/4hkI+Ii1QDsqJHiJcQE9dcSJn2d8eBHqAsQ0NqkfIhFGGp7+n8tTvSx5fRS7+XmN23+0GYhE3Yvyz5hqpxPc2j/zolBziEJcP6JtOd7uaZgeVMt+z74JleyMqIuk5VInaz9gNThoKpA4D8M2vPrDOr5+jN22ur9OeLdzl+ZH5C4ridyinSw/ccQr6AAyEc6zC3/7hwnfn0Ffmt+xj8/rC3FP0mP1uTfat0PkxENfiodI3+woNRlO62ltKHFxMPS2A97KxNo3UVVqxkol8S1HOt0Dkr/9M1XpL5ZFD7l0UY23f6GiYrqT98Jjgv2yOZDHvBr8PqLa0j/iPFqXxhNenrVPPwqMGM0YKySnbPl2IEVwa+qdE7O89NmzdHB7q6+/lJPdSknor6e8ZGGddxVZ8="
  distributions: sdist bdist_wheel
  on:
    tags: true
    condition: $TOXENV = check
    repo: AtteqCom/zsl
